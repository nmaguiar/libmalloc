name: Builds

on  :
  ## Comment the entries below you won't be needing
  #  (and double-check if you repo uses 'main' or 'master')
  #push        :
    #branches:
    #- main
    #paths:
    #- 'xyz/**'
    #paths-ignore:
    #- '.github/**'
  #pull_request:
    #branches:
    #- main
    #paths:
    #- 'xyz/**'
    #paths-ignore:
    #- '.github/**'
  #schedule    :
  #- cron: '30 6 * * *'

  ## Uncomment and adapt the following lines to trigger the action upon complete of another
  ##
  #workflow_run:
  #  workflows:
  #    - 'main.yml'
  #  types:
  #    - completed

  workflow_dispatch:
  ## Uncomment the following lines if you need to provide specific inputs
  ##
  #  inputs:
  #    inputOne:
  #      description: 'Sample input to use'
  #      required   : true
  #      default    : 'some value'

jobs:
  # ============
  buildUBIJEamd64:
    runs-on: ubuntu-latest 
    permissions:
      contents     : write
      pull-requests: write

    steps  :
    - name: Cache OpenAF runtime
      uses: actions/cache@v3
      with:
        key : oaf-t8
        path: /tmp/oaf

    # --------------
    - name: Checkout
      uses: actions/checkout@v3


    # -----------
    - name: Build
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: build.yaml
        args: 'op=buildUBIJE arch=amd64'
        dist: t8

    # -----------------------
    - name: Clean and version
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: cleanAndVersion.yaml
        args: 'path=buildUBIJE'
        dist: t8

    # -------------------
    - name: Upload output
      uses: actions/upload-artifact@v3
      with:
        name: libjemalloc-${{ env.version }}_ubi9-x64.tgz
        path: buildUBIJE

  # ============
  buildUBIJEarm64:
    runs-on: ubuntu-latest 
    permissions:
      contents     : write
      pull-requests: write

    steps  :
    - name: Cache OpenAF runtime
      uses: actions/cache@v3
      with:
        key : oaf-t8
        path: /tmp/oaf

    # --------------
    - name: Checkout
      uses: actions/checkout@v3

    # -----------------
    - name: Set up QEMU
      uses: docker/setup-qemu-action@v2

    # -----------
    - name: Build
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: build.yaml
        args: 'op=buildUBIJE arch=arm64'
        dist: t8

    # -----------------------
    - name: Clean and version
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: cleanAndVersion.yaml
        args: 'path=buildUBIJE'
        dist: t8

    # -------------------
    - name: Upload output
      uses: actions/upload-artifact@v3
      with:
        name: libjemalloc-${{ env.version }}_ubi9-aarch64.tgz
        path: buildUBIJE

  # ============
  buildUBITCamd64:
    runs-on: ubuntu-latest 
    permissions:
      contents     : write
      pull-requests: write

    steps  :
    - name: Cache OpenAF runtime
      uses: actions/cache@v3
      with:
        key : oaf-t8
        path: /tmp/oaf

    # --------------
    - name: Checkout
      uses: actions/checkout@v3


    # -----------
    - name: Build
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: build.yaml
        args: 'op=buildUBITC arch=amd64'
        dist: t8

    # -----------------------
    - name: Clean and version
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: cleanAndVersion.yaml
        args: 'path=buildUBITC'
        dist: t8

    # -------------------
    - name: Upload output
      uses: actions/upload-artifact@v3
      with:
        name: libjemalloc-${{ env.version }}_ubi9-x64.tgz
        path: buildUBITC

  # ============
  buildUBITCarm64:
    runs-on: ubuntu-latest 
    permissions:
      contents     : write
      pull-requests: write

    steps  :
    - name: Cache OpenAF runtime
      uses: actions/cache@v3
      with:
        key : oaf-t8
        path: /tmp/oaf

    # --------------
    - name: Checkout
      uses: actions/checkout@v3

    # -----------------
    - name: Set up QEMU
      uses: docker/setup-qemu-action@v2

    # -----------
    - name: Build
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: build.yaml
        args: 'op=buildUBITC arch=arm64'
        dist: t8

    # -----------------------
    - name: Clean and version
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: cleanAndVersion.yaml
        args: 'path=buildUBITC'
        dist: t8

    # -------------------
    - name: Upload output
      uses: actions/upload-artifact@v3
      with:
        name: libjemalloc-${{ env.version }}_ubi9-aarch64.tgz
        path: buildUBITC

  # ============
  buildUBI8JEamd64:
    runs-on: ubuntu-latest 
    permissions:
      contents     : write
      pull-requests: write

    steps  :
    - name: Cache OpenAF runtime
      uses: actions/cache@v3
      with:
        key : oaf-t8
        path: /tmp/oaf

    # --------------
    - name: Checkout
      uses: actions/checkout@v3


    # -----------
    - name: Build
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: build.yaml
        args: 'op=buildUBI8JE arch=amd64'
        dist: t8

    # -----------------------
    - name: Clean and version
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: cleanAndVersion.yaml
        args: 'path=buildUBI8JE'
        dist: t8

    # -------------------
    - name: Upload output
      uses: actions/upload-artifact@v3
      with:
        name: libjemalloc-${{ env.version }}_ubi8-x64.tgz
        path: buildUBI8JE

  # ============
  buildUBI8JEarm64:
    runs-on: ubuntu-latest 
    permissions:
      contents     : write
      pull-requests: write

    steps  :
    - name: Cache OpenAF runtime
      uses: actions/cache@v3
      with:
        key : oaf-t8
        path: /tmp/oaf

    # --------------
    - name: Checkout
      uses: actions/checkout@v3

    # -----------------
    - name: Set up QEMU
      uses: docker/setup-qemu-action@v2

    # -----------
    - name: Build
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: build.yaml
        args: 'op=buildUBI8JE arch=arm64'
        dist: t8

    # -----------------------
    - name: Clean and version
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: cleanAndVersion.yaml
        args: 'path=buildUBI8JE'
        dist: t8

    # -------------------
    - name: Upload output
      uses: actions/upload-artifact@v3
      with:
        name: libjemalloc-${{ env.version }}_ubi8-aarch64.tgz
        path: buildUBI8JE

  # ============
  buildUBI8TCamd64:
    runs-on: ubuntu-latest 
    permissions:
      contents     : write
      pull-requests: write

    steps  :
    - name: Cache OpenAF runtime
      uses: actions/cache@v3
      with:
        key : oaf-t8
        path: /tmp/oaf

    # --------------
    - name: Checkout
      uses: actions/checkout@v3


    # -----------
    - name: Build
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: build.yaml
        args: 'op=buildUBI8TC arch=amd64'
        dist: t8

    # -----------------------
    - name: Clean and version
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: cleanAndVersion.yaml
        args: 'path=buildUBI8TC'
        dist: t8

    # -------------------
    - name: Upload output
      uses: actions/upload-artifact@v3
      with:
        name: libjemalloc-${{ env.version }}_ubi8-x64.tgz
        path: buildUBI8TC

  # ============
  buildUBI8TCarm64:
    runs-on: ubuntu-latest 
    permissions:
      contents     : write
      pull-requests: write

    steps  :
    - name: Cache OpenAF runtime
      uses: actions/cache@v3
      with:
        key : oaf-t8
        path: /tmp/oaf

    # --------------
    - name: Checkout
      uses: actions/checkout@v3

    # -----------------
    - name: Set up QEMU
      uses: docker/setup-qemu-action@v2

    # -----------
    - name: Build
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: build.yaml
        args: 'op=buildUBI8TC arch=arm64'
        dist: t8

    # -----------------------
    - name: Clean and version
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: cleanAndVersion.yaml
        args: 'path=buildUBI8TC'
        dist: t8

    # -------------------
    - name: Upload output
      uses: actions/upload-artifact@v3
      with:
        name: libjemalloc-${{ env.version }}_ubi8-aarch64.tgz
        path: buildUBI8TC

  # ============
  buildAlpineJEamd64:
    runs-on: ubuntu-latest 
    permissions:
      contents     : write
      pull-requests: write

    steps  :
    - name: Cache OpenAF runtime
      uses: actions/cache@v3
      with:
        key : oaf-t8
        path: /tmp/oaf

    # --------------
    - name: Checkout
      uses: actions/checkout@v3


    # -----------
    - name: Build
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: build.yaml
        args: 'op=buildAlpineJE arch=amd64'
        dist: t8

    # -----------------------
    - name: Clean and version
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: cleanAndVersion.yaml
        args: 'path=buildAlpineJE'
        dist: t8

    # -------------------
    - name: Upload output
      uses: actions/upload-artifact@v3
      with:
        name: libjemalloc-${{ env.version }}_alpine-x64.tgz
        path: buildAlpineJE

  # ============
  buildAlpineJEarm64:
    runs-on: ubuntu-latest 
    permissions:
      contents     : write
      pull-requests: write

    steps  :
    - name: Cache OpenAF runtime
      uses: actions/cache@v3
      with:
        key : oaf-t8
        path: /tmp/oaf

    # --------------
    - name: Checkout
      uses: actions/checkout@v3

    # -----------------
    - name: Set up QEMU
      uses: docker/setup-qemu-action@v2

    # -----------
    - name: Build
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: build.yaml
        args: 'op=buildAlpineJE arch=arm64'
        dist: t8

    # -----------------------
    - name: Clean and version
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: cleanAndVersion.yaml
        args: 'path=buildAlpineJE'
        dist: t8

    # -------------------
    - name: Upload output
      uses: actions/upload-artifact@v3
      with:
        name: libjemalloc-${{ env.version }}_alpine-aarch64.tgz
        path: buildAlpineJE

  # ============
  buildAlpineTCamd64:
    runs-on: ubuntu-latest 
    permissions:
      contents     : write
      pull-requests: write

    steps  :
    - name: Cache OpenAF runtime
      uses: actions/cache@v3
      with:
        key : oaf-t8
        path: /tmp/oaf

    # --------------
    - name: Checkout
      uses: actions/checkout@v3


    # -----------
    - name: Build
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: build.yaml
        args: 'op=buildAlpineTC arch=amd64'
        dist: t8

    # -----------------------
    - name: Clean and version
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: cleanAndVersion.yaml
        args: 'path=buildAlpineTC'
        dist: t8

    # -------------------
    - name: Upload output
      uses: actions/upload-artifact@v3
      with:
        name: libjemalloc-${{ env.version }}_alpine-x64.tgz
        path: buildAlpineTC

  # ============
  buildAlpineTCarm64:
    runs-on: ubuntu-latest 
    permissions:
      contents     : write
      pull-requests: write

    steps  :
    - name: Cache OpenAF runtime
      uses: actions/cache@v3
      with:
        key : oaf-t8
        path: /tmp/oaf

    # --------------
    - name: Checkout
      uses: actions/checkout@v3

    # -----------------
    - name: Set up QEMU
      uses: docker/setup-qemu-action@v2

    # -----------
    - name: Build
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: build.yaml
        args: 'op=buildAlpineTC arch=arm64'
        dist: t8

    # -----------------------
    - name: Clean and version
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: cleanAndVersion.yaml
        args: 'path=buildAlpineTC'
        dist: t8

    # -------------------
    - name: Upload output
      uses: actions/upload-artifact@v3
      with:
        name: libjemalloc-${{ env.version }}_alpine-aarch64.tgz
        path: buildAlpineTC

  # ============
  buildOracle8JEamd64:
    runs-on: ubuntu-latest 
    permissions:
      contents     : write
      pull-requests: write

    steps  :
    - name: Cache OpenAF runtime
      uses: actions/cache@v3
      with:
        key : oaf-t8
        path: /tmp/oaf

    # --------------
    - name: Checkout
      uses: actions/checkout@v3


    # -----------
    - name: Build
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: build.yaml
        args: 'op=buildOracle8JE arch=amd64'
        dist: t8

    # -----------------------
    - name: Clean and version
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: cleanAndVersion.yaml
        args: 'path=buildOracle8JE'
        dist: t8

    # -------------------
    - name: Upload output
      uses: actions/upload-artifact@v3
      with:
        name: libjemalloc-${{ env.version }}_oracle8-x64.tgz
        path: buildOracle8JE

  # ============
  buildOracle8JEarm64:
    runs-on: ubuntu-latest 
    permissions:
      contents     : write
      pull-requests: write

    steps  :
    - name: Cache OpenAF runtime
      uses: actions/cache@v3
      with:
        key : oaf-t8
        path: /tmp/oaf

    # --------------
    - name: Checkout
      uses: actions/checkout@v3

    # -----------------
    - name: Set up QEMU
      uses: docker/setup-qemu-action@v2

    # -----------
    - name: Build
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: build.yaml
        args: 'op=buildOracle8JE arch=arm64'
        dist: t8

    # -----------------------
    - name: Clean and version
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: cleanAndVersion.yaml
        args: 'path=buildOracle8JE'
        dist: t8

    # -------------------
    - name: Upload output
      uses: actions/upload-artifact@v3
      with:
        name: libjemalloc-${{ env.version }}_oracle8-aarch64.tgz
        path: buildOracle8JE

  # ============
  buildOracle8TCamd64:
    runs-on: ubuntu-latest 
    permissions:
      contents     : write
      pull-requests: write

    steps  :
    - name: Cache OpenAF runtime
      uses: actions/cache@v3
      with:
        key : oaf-t8
        path: /tmp/oaf

    # --------------
    - name: Checkout
      uses: actions/checkout@v3


    # -----------
    - name: Build
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: build.yaml
        args: 'op=buildOracle8TC arch=amd64'
        dist: t8

    # -----------------------
    - name: Clean and version
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: cleanAndVersion.yaml
        args: 'path=buildOracle8TC'
        dist: t8

    # -------------------
    - name: Upload output
      uses: actions/upload-artifact@v3
      with:
        name: libjemalloc-${{ env.version }}_oracle8-x64.tgz
        path: buildOracle8TC

  # ============
  buildOracle8TCarm64:
    runs-on: ubuntu-latest 
    permissions:
      contents     : write
      pull-requests: write

    steps  :
    - name: Cache OpenAF runtime
      uses: actions/cache@v3
      with:
        key : oaf-t8
        path: /tmp/oaf

    # --------------
    - name: Checkout
      uses: actions/checkout@v3

    # -----------------
    - name: Set up QEMU
      uses: docker/setup-qemu-action@v2

    # -----------
    - name: Build
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: build.yaml
        args: 'op=buildOracle8TC arch=arm64'
        dist: t8

    # -----------------------
    - name: Clean and version
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: cleanAndVersion.yaml
        args: 'path=buildOracle8TC'
        dist: t8

    # -------------------
    - name: Upload output
      uses: actions/upload-artifact@v3
      with:
        name: libjemalloc-${{ env.version }}_oracle8-aarch64.tgz
        path: buildOracle8TC

  # ============
  buildOracle9JEamd64:
    runs-on: ubuntu-latest 
    permissions:
      contents     : write
      pull-requests: write

    steps  :
    - name: Cache OpenAF runtime
      uses: actions/cache@v3
      with:
        key : oaf-t8
        path: /tmp/oaf

    # --------------
    - name: Checkout
      uses: actions/checkout@v3


    # -----------
    - name: Build
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: build.yaml
        args: 'op=buildOracle9JE arch=amd64'
        dist: t8

    # -----------------------
    - name: Clean and version
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: cleanAndVersion.yaml
        args: 'path=buildOracle9JE'
        dist: t8

    # -------------------
    - name: Upload output
      uses: actions/upload-artifact@v3
      with:
        name: libjemalloc-${{ env.version }}_oracle9-x64.tgz
        path: buildOracle9JE

  # ============
  buildOracle9JEarm64:
    runs-on: ubuntu-latest 
    permissions:
      contents     : write
      pull-requests: write

    steps  :
    - name: Cache OpenAF runtime
      uses: actions/cache@v3
      with:
        key : oaf-t8
        path: /tmp/oaf

    # --------------
    - name: Checkout
      uses: actions/checkout@v3

    # -----------------
    - name: Set up QEMU
      uses: docker/setup-qemu-action@v2

    # -----------
    - name: Build
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: build.yaml
        args: 'op=buildOracle9JE arch=arm64'
        dist: t8

    # -----------------------
    - name: Clean and version
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: cleanAndVersion.yaml
        args: 'path=buildOracle9JE'
        dist: t8

    # -------------------
    - name: Upload output
      uses: actions/upload-artifact@v3
      with:
        name: libjemalloc-${{ env.version }}_oracle9-aarch64.tgz
        path: buildOracle9JE

  # ============
  buildOracle9TCamd64:
    runs-on: ubuntu-latest 
    permissions:
      contents     : write
      pull-requests: write

    steps  :
    - name: Cache OpenAF runtime
      uses: actions/cache@v3
      with:
        key : oaf-t8
        path: /tmp/oaf

    # --------------
    - name: Checkout
      uses: actions/checkout@v3


    # -----------
    - name: Build
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: build.yaml
        args: 'op=buildOracle9TC arch=amd64'
        dist: t8

    # -----------------------
    - name: Clean and version
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: cleanAndVersion.yaml
        args: 'path=buildOracle9TC'
        dist: t8

    # -------------------
    - name: Upload output
      uses: actions/upload-artifact@v3
      with:
        name: libjemalloc-${{ env.version }}_oracle9-x64.tgz
        path: buildOracle9TC

  # ============
  buildOracle9TCarm64:
    runs-on: ubuntu-latest 
    permissions:
      contents     : write
      pull-requests: write

    steps  :
    - name: Cache OpenAF runtime
      uses: actions/cache@v3
      with:
        key : oaf-t8
        path: /tmp/oaf

    # --------------
    - name: Checkout
      uses: actions/checkout@v3

    # -----------------
    - name: Set up QEMU
      uses: docker/setup-qemu-action@v2

    # -----------
    - name: Build
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: build.yaml
        args: 'op=buildOracle9TC arch=arm64'
        dist: t8

    # -----------------------
    - name: Clean and version
      uses: openaf/ojob-action@v4
      env :
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        ojob: cleanAndVersion.yaml
        args: 'path=buildOracle9TC'
        dist: t8

    # -------------------
    - name: Upload output
      uses: actions/upload-artifact@v3
      with:
        name: libjemalloc-${{ env.version }}_oracle9-aarch64.tgz
        path: buildOracle9TC

